## 早期（编译器）优化
### 一、概述
前端编译器：把.java文件转变成.class文件的过程,Sun的Javac
JIT编译器：后端运行期编译器（Just in time Compiler ），把字节码转变成机器码，HotSpot VM的C1、C2编译器
AOT编译器：直接吧.java文件编译成本地机器码代码

本章接仅限于第一种编译过程

### 二、Javac编译器

编译过程分为3个过程
* 解析与填充符号表过程
* 插入式注解处理器的注解处理过程
* 分析与字节码生成过程

#### 1、解析与填充符号表
**解析步骤包括词法分析、语法分析两个过程**
* 词法分析是将源代码的字符流转变为标记(Token)集合,单个字符是程序编写过程的最小元素，而标记则是编译过程的最小元素，
关键字、变量名、字面量、运算符都可以成为标记。
* 语法分析是根据标记序列构造抽象语法树（Abstract Syntax Tree）的过程，抽象语法树是一种用来描述程序代码语法结构的树形表示方式，
语法树的每一个节点都代表着程序代码中的一个语法结构，例如包、类型、修饰符、运算符、接口、返回值甚至代码注解。

符号表（Symbol table）是由一组符号地址和符号信息构成的表格

#### 2、注解处理器
插入式注解处理器在编译期间对注解进行处理，可以读取、修改添加抽象语法树中的任意元素

#### 3、语义分析与字节码生成
语义分析过程分为标注检查以及数据及控制流分析两个步骤；
标注检查的内容包括诸如变量使用前是否已被声明、变量与赋值之间的数据类型是否匹配等。
标注检查中还会进行常量折叠，例如定义：
       
    int a = 1 + 2；
在语法树上仍能看到字面量1、2,但经过常量折叠后，将会被折叠为字面量3。因此代码里定义“a=1+2”比起直接定义“a=3”并不会增加程序
运行期一个CPU指令的运算量。

数据及控制流分析可以检查出程序局部变量使用前是否赋值、方法的每条路径是否都有返回值、是否异常都被正确处理。

字节码生成结束不仅仅是把前面各个步骤所生成的信息转化成字节码写到磁盘中，编译器还进行了代码添加和转化工作。
例如实例构造器<init>()方法、类构造器<cinit>()方法，就是在这个阶段添加到语法树中；
（如果代码中没有提供任何构造函数，编译器会添加一个没有参数访问性与当前类一致的默认构造函数，这个步骤在填充符号表完成）

编译器会把语句块、变量初始化、调用父类的实例构造器等操作收敛到对于<init>()方法、类构造器<cinit>()方法中，并保证
按照先执行父类实例构造器、然后初始化变量最后执行语句块的顺序。

代码替换、优化工作：把字符串的加操作替换为StringBuffer或StringBuilder的append()操作（需jdk 1.5以后）。

    public static void main(String[] args) {

        String s = "";
        String s1 = "C";
        s = "A" + "B" + s1;
    }
    //.class 文件 显示
    public static void main(String[] args) {
        String s = "";
        String s1 = "C";
        (new StringBuilder()).append("AB").append(s1).toString();
    }
 
### 三、java语法糖的味道
在计算机语言中添加某种语法，方便程序员使用，增加可读性，减少代码出错机会。
解语法糖：虚拟机运行时并不支持这些语法，在编译阶段还原回简单的基础语法结构